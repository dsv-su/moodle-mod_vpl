{"version":3,"file":"vplui.min.js","sources":["../src/vplui.js"],"sourcesContent":["// This file is part of VPL for Moodle - http://vpl.dis.ulpgc.es/\n//\n// VPL for Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// VPL for Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with VPL for Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Tools for the VPL IDE\n *\n * @copyright 2016 Juan Carlos Rodríguez-del-Pino\n * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @author Juan Carlos Rodríguez-del-Pino <jcrodriguez@dis.ulpgc.es>\n */\n\n/* globals JUnzip */\n/* globals JSInflate */\n\ndefine(\n    [\n        'jquery',\n        'jqueryui',\n        'mod_vpl/vplutil',\n    ],\n    function($, jqui, VPLUtil) {\n        var VPLUI = {};\n        // Get scrollBarWidth.\n        VPLUI.scrollBarWidth = function() {\n            var parent, child, width;\n            parent = $('<div style=\"width:50px;height:50px;overflow:auto\"><div/></div>').appendTo('body');\n            child = parent.children();\n            width = child.innerWidth() - child.height(99).innerWidth();\n            parent.remove();\n            return width;\n        };\n        VPLUI.readZipFile = function(data, save, progressBar, end) {\n            if (!end) {\n                end = VPLUtil.doNothing;\n            }\n            if (typeof JUnzip == 'undefined') {\n                VPLUtil.loadScript(['/zip/inflate.js', '/zip/unzip.js']\n                , function() {\n                    VPLUI.readZipFile(data, save, progressBar, end);\n                });\n                return;\n            }\n            var ab = VPLUtil.ArrayBuffer2String(data);\n            var unzipper = new JUnzip(ab);\n            if (!unzipper.isZipFile()) {\n                VPLUtil.log('Not a ZIP file');\n                end();\n                return;\n            }\n            unzipper.readEntries();\n            var out = unzipper.entries.length;\n            /**\n             * Process each entry in the zip file.\n             * Recursive process.\n             * @param {int} i Entry to process.\n             */\n            function process(i) {\n                if (i >= out || progressBar.isClosed()) {\n                    end();\n                    return;\n                }\n                var entry = unzipper.entries[i];\n                var fileName = entry.fileName;\n                var data;\n                // Is directory entry then skip.\n                if (fileName.match(/\\/$/)) {\n                    process(i + 1);\n                } else {\n                    progressBar.processFile(fileName);\n                    var uncompressed = '';\n                    if (entry.compressionMethod === 0) {\n                        // Plain file.\n                        uncompressed = entry.data;\n                    } else if (entry.compressionMethod === 8) {\n                        uncompressed = JSInflate.inflate(entry.data);\n                    }\n                    if (VPLUtil.isBinary(fileName)) {\n                        // If binary use as arrayBuffer.\n                        save({name: fileName, contents: btoa(uncompressed), encoding: 1});\n                        // TODO Show message when error.\n                        process(i + 1);\n                    } else {\n                        data = VPLUtil.String2ArrayBuffer(uncompressed);\n                        var blob = new Blob([data], {\n                            type: 'text/plain'\n                        });\n                        var fr = new FileReader();\n                        fr.onload = function(e) {\n                            save({name: fileName, contents: e.target.result, encoding: 0});\n                            process(i + 1);\n                        };\n                        fr.onerror = function(e) {\n                            VPLUtil.log(e);\n                            i = out;\n                            process(i + 1);\n                            // TODO Show message when error.\n                        };\n                        fr.readAsText(blob);\n                    }\n                }\n            }\n            process(0);\n        };\n\n        VPLUI.readSelectedFiles = function(filesToRead, save, end) {\n            // Process all File objects.\n            var pb = new VPLUI.progressBar('import', 'import');\n            var errorsMessages = '';\n            if (!end) {\n                end = VPLUtil.doNothing;\n            }\n            pb.processFile = function(name) {\n                pb.setLabel(name);\n            };\n            /**\n             * Read each file in filesToReas\n             * Recursive process.\n             * @param {int} sec secuencial file to read\n             */\n            function readSecuencial(sec) {\n                if (sec >= filesToRead.length || pb.isClosed()) {\n                    end();\n                    pb.close();\n                    if (errorsMessages > '') {\n                        VPLUI.showErrorMessage(errorsMessages);\n                    }\n                    return;\n                }\n                var f = filesToRead[sec];\n                pb.processFile(f.name);\n                var binary = VPLUtil.isBinary(f.name);\n                var reader = new FileReader();\n                var ext = VPLUtil.fileExtension(f.name).toLowerCase();\n                reader.onload = function(e) {\n                    if (binary) {\n                        if (ext == 'zip') {\n                            try {\n                                VPLUI.readZipFile(e.target.result, save, pb, function() {\n                                                                                  readSecuencial(sec + 1);\n                                                                               });\n                                return;\n                            } catch (ex) {\n                                VPLUI.showErrorMessage(ex + \" : \" + f.name);\n                            }\n                        } else {\n                            var data = VPLUtil.dataFromURLData(e.target.result);\n                            save({name: f.name, contents: data, encoding: 1});\n                        }\n                    } else {\n                        save({name: f.name, contents: e.target.result, encoding: 0});\n                    }\n                    readSecuencial(sec + 1);\n                };\n                reader.onerror = function(e) {\n                    errorsMessages += \"Error \\\"\" + e.target.error + \"\\\" reading \" + f.name + \"\\n\";\n                    readSecuencial(sec + 1);\n                };\n                if (binary) {\n                    if (ext == 'zip') {\n                        reader.readAsArrayBuffer(f);\n                    } else {\n                        reader.readAsDataURL(f);\n                    }\n                } else {\n                    reader.readAsText(f);\n                }\n            }\n            readSecuencial(0);\n        };\n        VPLUI.dialogbaseOptions = {\n            minWidth: 200,\n            autoOpen: false,\n            width: 'auto',\n            closeText: VPLUtil.str('cancel'),\n            modal: true,\n            classes: {\n                \"ui-dialog\":  'vpl_ide vpl_ide_dialog',\n            },\n        };\n        VPLUI.iconModified = function() {\n            var html = '<span title=\"' + VPLUtil.str('modified') + '\" class=\"vpl_ide_charicon\">';\n            html += '<i class=\"fa fa-star\"></i>' + '</span> ';\n            return html;\n        };\n        VPLUI.iconDelete = function() {\n            var html = ' <span title=\"' + VPLUtil.str('delete') + '\" class=\"vpl_ide_charicon vpl_ide_delicon\">';\n            html += '<i class=\"fa fa-trash\"></i>' + '</span> ';\n            return html;\n        };\n        VPLUI.iconClose = function() {\n            var html = ' <span title=\"' + VPLUtil.str('closebuttontitle');\n            html += '\" class=\"vpl_ide_charicon vpl_ide_closeicon\">' + '<i class=\"fa fa-remove\"></i>' + '</span> ';\n            return html;\n        };\n        VPLUI.iconRequired = function() {\n            var html = ' <span title=\"' + VPLUtil.str('required') + '\" class=\"vpl_ide_charicon\">';\n            html += '<i class=\"fa fa-shield\"></i>' + '</span> ';\n            return html;\n        };\n        VPLUI.iconReadOnly = function() {\n            var html = ' <span title=\"' + VPLUtil.str('readOnly') + '\" class=\"vpl_ide_charicon\">';\n            html += '<i class=\"fa fa-lock\"></i>' + '</span> ';\n            return html;\n        };\n        VPLUI.iconFolder = function() {\n            return '<i class=\"fa fa-folder-open-o\"></i>';\n        };\n        (function() {\n            var menuIcons = {\n                'filelist': 'folder-open-o',\n                'filelistclose': 'folder-o',\n                'new': 'file-code-o',\n                'rename': 'pencil',\n                'delete': 'trash',\n                'multidelete': 'trash|list',\n                'showparentfiles': 'eye|files-o',\n                'close': 'remove',\n                'comments': 'commenting',\n                'import': 'upload',\n                'print': 'print',\n                'edit': 'edit',\n                'undo': 'undo',\n                'redo': 'repeat',\n                'select_all': 'location-arrow',\n                'find': 'search',\n                'find_replace': 'exchange',\n                'next': 'search-plus',\n                'resetfiles': 'refresh',\n                'download': 'download',\n                'fullscreen': 'expand',\n                'regularscreen': 'compress',\n                'save': 'save',\n                'shortcuts': 'flash',\n                'sort': 'list-ol',\n                'run': 'rocket',\n                'running': 'rocket fa-spin',\n                'debug': 'bug',\n                'evaluate': 'check-square-o',\n                'console': 'terminal',\n                'about': 'question',\n                'info': 'info-circle',\n                'alert': 'warning',\n                'trash': 'trash',\n                'retrieve': 'download',\n                'spinner': 'refresh fa-spin',\n                'keyboard': 'keyboard-o',\n                'clipboard': 'clipboard',\n                'timeleft': 'clock-o',\n                'copy': 'copy',\n                'paste': 'paste',\n                'more': 'plus-square',\n                'less': 'minus-square',\n                'resize': 'arrows-alt',\n                'graphic': 'picture-o',\n                'send': 'send',\n                'theme':  'paint-brush',\n                'user': 'user',\n                'fontsize': 'text-height',\n                'close-rightpanel': 'caret-square-o-right',\n                'open-rightpanel': 'caret-square-o-left'\n            };\n            VPLUI.genIcon = function(icon, size) {\n                if (!menuIcons[icon]) {\n                    return '';\n                }\n                var classes = 'fa fa-';\n                if (!size) {\n                    classes += 'lg';\n                } else {\n                    classes += size;\n                }\n                var icons = menuIcons[icon].split('|');\n                var ret = '';\n                for (var i = 0; i < icons.length; i++) {\n                    ret += \"<i class='\" + classes + ' fa-' + icons[i] + \"'></i>\";\n                }\n                return ret;\n            };\n        })();\n        // UI operations.\n        VPLUI.setTitleBar = function(dialog, type, icon, buttons, handler) {\n            var title = $(dialog).parent().find(\"span.ui-dialog-title\");\n            /**\n             * Generate HTML for a button with icon\n             * @param {string} e name of botton.\n             * @returns {string} Html tag <a> as a button.\n             */\n            function genButton(e) {\n                var html = \"<a id='vpl_\" + type + \"_\" + e + \"' href='#' title='\" + VPLUtil.str(e) + \"'>\";\n                html += VPLUI.genIcon(e, 'fw') + \"</a>\";\n                return html;\n            }\n            var html = VPLUI.genIcon(icon);\n            html += \" <span class='\" + type + \"-title-buttons'></span>\";\n            html += \"<span class='\" + type + \"-title-text'></span>\";\n            title.html(html);\n            var titleButtons = title.find(\"span.\" + type + \"-title-buttons\");\n            var titleText = title.find(\"span.\" + type + \"-title-text\");\n            html = \"\";\n            for (var i = 0; i < buttons.length; i++) {\n                html += genButton(buttons[i]);\n            }\n            titleButtons.html(html);\n            for (var ih = 0; ih < handler.length; ih++) {\n                var button = title.find('#vpl_' + type + '_' + buttons[ih]);\n                button.button().click(handler[ih]);\n                button.css('padding', '1px 3px');\n            }\n            titleButtons.on('focus', '*', function() {\n                                              $(this).blur();\n                                          });\n            return titleText;\n        };\n        VPLUI.setDialogTitleIcon = function(dialog, icon) {\n            var title = $(dialog).parent().find(\"span.ui-dialog-title\");\n            title.html(VPLUI.genIcon(icon) + ' ' + title.html());\n        };\n        VPLUI.progressBar = function(title, message, onUserClose) {\n            var labelHTML = '<span class=\"vpl_ide_progressbarlabel\"></span>';\n            var sppiner = '<div class=\"vpl_ide_progressbaricon\">' + VPLUI.genIcon('spinner') + '</div>';\n            var pbHTML = ' <div class=\"vpl_ide_progressbar\">' + sppiner + labelHTML + '</div>';\n            var HTML = '<div class=\"vpl_ide_dialog\" style=\"display:none;\">' + pbHTML + '</div>';\n            var dialog = $(HTML);\n            $('body').append(dialog);\n            var progressbar = dialog.find('.vpl_ide_progressbar');\n            var label = progressbar.find('.vpl_ide_progressbarlabel');\n            dialog.dialog({\n                'title': VPLUtil.str(title),\n                resizable: false,\n                autoOpen: false,\n                width: 200,\n                height: 20,\n                minHeight: 20,\n                modal: true,\n                classes: {\n                    \"ui-dialog\":  'vpl_ide vpl_ide_dialog',\n                },\n                close: function(event) {\n                    if (dialog) {\n                        if (onUserClose && event.originalEvent) {\n                            onUserClose();\n                        }\n                        onUserClose = false;\n                    }\n                }\n            });\n            this.setLabel = function(t, icon) {\n                if (dialog) {\n                    label.text(t);\n                    if (icon) {\n                        label.html(VPLUI.genIcon(icon) + ' ' + label.html());\n                    }\n                }\n            };\n            this.close = function() {\n                if (dialog) {\n                    dialog.dialog('destroy');\n                    $(dialog).remove();\n                    dialog = false;\n                }\n            };\n            this.isClosed = function() {\n                return dialog === false;\n            };\n            var titleTag = dialog.siblings().find('.ui-dialog-title');\n            titleTag.html(VPLUI.genIcon(title) + ' ' + titleTag.html());\n            this.setLabel(VPLUtil.str(message));\n            dialog.dialog('open');\n            dialog.dialog('option', 'height', 'auto');\n        };\n        /**\n         * Shows a dialog with a message.\n         * @param {string} message\n         * @param {Object} initialoptions icon, title, actions handler (ok, yes, no, close)\n         * @returns {JQuery} JQueryUI Dialog object already open\n         */\n        VPLUI.showMessage = function(message, initialoptions) {\n            var options = $.extend({}, VPLUI.dialogbaseOptions, initialoptions);\n            var messageDialog = $('<div class=\"vpl_ide_dialog\" style=\"display:none\"></div>');\n            var icon = '';\n            var contents = ' <span class=\"dmessage\">' + message.replace(/\\n/g, '<br>') + '</span>';\n            messageDialog.html(contents);\n            if (typeof options.icon == 'undefined') {\n                icon = 'info';\n            } else {\n                icon = options.icon;\n                delete options.icon;\n            }\n            if (!options.title) {\n                options.title = VPLUtil.str('warning');\n            }\n            $('body').append(messageDialog);\n            var messageButtons = {};\n            if (typeof initialoptions.ok == 'function') {\n                messageButtons[VPLUtil.str('ok')] = function() {\n                    $(this).dialog('close');\n                    initialoptions.ok();\n                };\n                messageButtons[VPLUtil.str('cancel')] = function() {\n                    $(this).dialog('close');\n                };\n                delete options.ok;\n            } else if (typeof initialoptions.yes == 'function') {\n                messageButtons[VPLUtil.str('yes')] = function() {\n                    $(this).dialog('close');\n                    initialoptions.yes();\n                };\n                messageButtons[VPLUtil.str('no')] = function() {\n                    $(this).dialog('close');\n                };\n                delete options.yes;\n            }\n            if (typeof initialoptions.stop == 'function') {\n                messageButtons[VPLUtil.str('stop')] = function() {\n                    $(this).dialog('close');\n                    initialoptions.stop();\n                };\n                delete options.stop;\n            }\n            if (typeof initialoptions.next == 'function') {\n                messageButtons[VPLUtil.str('next')] = function() {\n                    $(this).dialog('close');\n                    initialoptions.next();\n                };\n                delete options.next;\n            }\n            options.close = function() {\n                    $(this).remove();\n                    if (initialoptions.close) {\n                        initialoptions.close();\n                    }\n            };\n            options.buttons = messageButtons;\n\n            messageDialog.dialog(options);\n            var titleTag = messageDialog.siblings().find('.ui-dialog-title');\n            titleTag.html(VPLUI.genIcon(icon) + ' ' + titleTag.html());\n\n            messageDialog.setMessage = function(men) {\n                $(messageDialog).find('.dmessage').html(men.replace(/\\n/g, '<br>'));\n            };\n\n            messageDialog.dialog('open');\n            return messageDialog;\n        };\n        VPLUI.showErrorMessage = function(message, options) {\n            var currentOptions = $.extend({}, VPLUI.dialogbaseOptions, {\n                title: VPLUtil.str('error'),\n                icon: 'alert'\n            });\n            if (options) {\n                currentOptions = $.extend(currentOptions, options);\n            }\n            return VPLUI.showMessage(message, currentOptions);\n        };\n        /**\n         * Request an action to de server: save, run, debug, evaluate, update, getresult, etc.\n         * @param {string} action Name of action to request.\n         * @param {string} title The title that shows the progress dialog\n         * @param {object} data Data to send to the server\n         * @param {string} URL URL to the server entry point, lacking action\n         * @param {boolean} noDialog If true then no dialog is shown\n         * @returns {deferred} Defferred object\n         */\n        VPLUI.requestAction = function(action, title, data, URL, noDialog) {\n            var deferred = $.Deferred();\n            var request = null;\n            var xhr = false;\n            var apb = false;\n            if (!noDialog) {\n                if (title === '') {\n                    title = 'connecting';\n                }\n                apb = new VPLUI.progressBar(action, title, function() {\n                    if (request.readyState != 4) {\n                        if (xhr && xhr.abort) {\n                            xhr.abort();\n                        }\n                    }\n                });\n            }\n            request = $.ajax({\n                beforeSend: function(jqXHR) {\n                    xhr = jqXHR;\n                    return true;\n                },\n                async: true,\n                type: \"POST\",\n                url: URL + action,\n                'data': JSON.stringify(data),\n                contentType: \"application/json; charset=utf-8\",\n                dataType: \"json\"\n            }).always(function() {\n                if (!noDialog) {\n                    apb.close();\n                }\n            }).done(function(response) {\n                if (!response.success) {\n                    deferred.reject(response.error);\n                } else {\n                    deferred.resolve(response.response);\n                }\n            }).fail(function(jqXHR, textStatus, errorThrown) {\n                var message = VPLUtil.str('connection_fail') + ': ' + textStatus;\n                if (window.VPLDebugMode && errorThrown.message != undefined) {\n                    message += ': ' + errorThrown.message;\n                }\n                VPLUtil.log(message);\n                deferred.reject(message);\n            });\n            return deferred;\n        };\n        VPLUI.clickServer = function(e) {\n            var w = 550;\n            var h = 450;\n            var left = (screen.width / 2) - (w / 2);\n            var top = (screen.height / 2) - (h / 2);\n            try {\n                var features = 'toolbar=no, location=no, directories=no, status=no, menubar=no';\n                features += ', resizable=yes, scrollbars=yes, copyhistory=no, width=' + w;\n                features += ', height=' + h + ', top=' + top + ', left=' + left;\n                var win = window.open($(this).attr('href'), '_blank', features);\n                if (!win) {\n                    return true;\n                }\n            } catch (ex) {\n                VPLUtil.log(ex);\n                return true;\n            }\n            e.preventDefault();\n            $(this).parent().hide();\n            return false;\n        };\n\n        VPLUI.acceptCertificates = function(servers, getLastAction) {\n            if (servers.length > 0) {\n                // Generate links dialog.\n                var html = VPLUtil.str('acceptcertificatesnote');\n                html += '<ol>';\n                var i;\n                for (i in servers) {\n                    if (servers.hasOwnProperty(i)) {\n                        var n = 1 + i;\n                        html += '<li><a href=\"' + servers[i] + '\" target=\"_blank\">Server ';\n                        html += n + '</a></li>';\n                    }\n                }\n                html += '</ol>';\n                var m = VPLUI.showMessage(html, {\n                    ok: function() {\n                        var action = getLastAction();\n                        if (action) {\n                            action();\n                        }\n                    },\n                    icon: 'unlocked',\n                    title: VPLUtil.str('acceptcertificates')\n                });\n                $(m).find('a').on('click keypress', VPLUI.clickServer);\n            } else {\n                VPLUtil.log('servers.length == 0');\n                VPLUI.showErrorMessage(VPLUtil.str('connection_fail'));\n            }\n        };\n        VPLUI.monitorRunning = VPLUtil.returnFalse;\n        VPLUI.webSocketMonitor = function(coninfo, title, running, externalActions) {\n            VPLUtil.setProtocol(coninfo);\n            VPLUtil.setProcessId(coninfo.processid);\n            var ws = null;\n            var pb = null;\n            var deferred = $.Deferred();\n            var defail = function(m) {\n                deferred.reject(m);\n                if (ws !== null) {\n                    ws.close();\n                }\n            };\n            var delegated = false;\n            var messageActions = {\n                'message': function(content) {\n                    var parsed = /^([^:]*):?([^]*)/.exec(content);\n                    var state = VPLUtil.sanitizeText(parsed[1]);\n                    var detail = VPLUtil.sanitizeText(parsed[2]);\n                    if (state == 'running') {\n                        state = running;\n                    }\n                    var text = VPLUtil.str(state);\n                    if (detail > '') {\n                        text += ': ' + detail;\n                    }\n                    if (pb !== null && !pb.isClosed()) {\n                        pb.setLabel(text);\n                    } else if (externalActions.getConsole && externalActions.getConsole().isOpen()) {\n                        externalActions.getConsole().setMessage(text);\n                    } else {\n                        VPLUtil.log('Error: no dialogo. Message not shown: ' + text);\n                    }\n                },\n                'compilation': function(content) {\n                    if (externalActions.setResult) {\n                        externalActions.setResult({\n                            'compilation': content,\n                        }, false);\n                    }\n                },\n                'retrieve': function() {\n                    var data = {\"processid\": coninfo.processid};\n                    pb.close();\n                    delegated = true;\n                    VPLUI.requestAction('retrieve', '', data, externalActions.ajaxurl)\n                    .done(\n                        function(response) {\n                            deferred.resolve();\n                            if (externalActions.setResult) {\n                                externalActions.setResult(response, true);\n                            }\n                        }\n                   ).fail(defail);\n                },\n                'run': function(content) {\n                    pb.close();\n                    externalActions.run(content, coninfo, ws);\n                },\n                'close': function() {\n                    VPLUtil.log('ws close message from jail');\n                    ws.close();\n                    var data = {\"processid\": coninfo.processid};\n                    VPLUI.requestAction('cancel', '', data, externalActions.ajaxurl, true);\n                }\n            };\n            try {\n                if (VPLUtil.supportWebSocket()) {\n                    ws = new WebSocket(coninfo.monitorURL);\n                } else {\n                    VPLUtil.log('ws not available');\n                    deferred.reject(VPLUtil.str('browserupdate'));\n                    return deferred;\n                }\n            } catch (e) {\n                VPLUtil.log('ws new say ' + e);\n                deferred.reject(e.message);\n                return deferred;\n            }\n            pb = new VPLUI.progressBar(title, 'connecting', function() {\n                deferred.reject('Stopped by user');\n                ws.close();\n            });\n            ws.notOpen = true;\n            ws.onopen = function() {\n                ws.notOpen = false;\n                pb.setLabel(VPLUtil.str('connected'));\n                if (externalActions.open) {\n                    externalActions.open();\n                }\n            };\n            ws.onerror = function(event) {\n                VPLUtil.log('ws error ' + event);\n                pb.close();\n                if (coninfo.secure && ws.notOpen) {\n                    VPLUI.requestAction('getjails', 'retrieve', {}, externalActions.ajaxurl)\n                    .done(function(response) {\n                        VPLUI.acceptCertificates(response.servers, function() {\n                            return externalActions.getLastAction();\n                        });\n                    })\n                    .fail(defail);\n                } else {\n                    deferred.reject(VPLUtil.str('connection_fail'));\n                }\n                if (externalActions.close) {\n                    VPLUtil.delay('externalActions.close', externalActions.close);\n                }\n            };\n            ws.onclose = function() {\n                if (externalActions.getConsole) {\n                    externalActions.getConsole().disconnect();\n                }\n                if (!ws.notOpen) {\n                    pb.close();\n                    if (!delegated && deferred.state() != 'rejected') {\n                        deferred.resolve();\n                    }\n                }\n                if (externalActions.close) {\n                    externalActions.close();\n                }\n            };\n\n            ws.onmessage = function(event) {\n                var message = /^([^:]+):([^]*)/.exec(event.data);\n                if (message !== null) {\n                    var action = message[1];\n                    var content = message[2];\n                    if (messageActions[action]) {\n                        messageActions[action](content);\n                    }\n                } else {\n                    pb.setLabel(VPLUtil.str('error') + ': ' + event.data);\n                }\n            };\n            VPLUI.monitorRunning = function() {\n                return ws !== null && ws.readyState != WebSocket.CLOSED;\n            };\n            return deferred;\n        };\n\n        VPLUI.hideIDEStatus = function() {\n            VPLUtil.delay('updateIDEStatus', function() {\n                $('.vpl_ide_status').hide();\n            });\n        };\n\n        VPLUI.showIDEStatus = function(status) {\n            VPLUtil.delay('updateIDEStatus', function() {\n                $('.vpl_ide_status').text(status);\n                $('.vpl_ide_status').show();\n            });\n        };\n\n        VPLUtil.init = VPLUtil.doNothing;\n        // Needs global use of VPLUtil for view source? Review.\n        window.VPLUI = VPLUI;\n        return VPLUI;\n    }\n);\n"],"names":["define","$","jqui","VPLUtil","menuIcons","VPLUI","scrollBarWidth","parent","child","width","appendTo","children","innerWidth","height","remove","readZipFile","data","save","progressBar","end","doNothing","JUnzip","ab","ArrayBuffer2String","unzipper","isZipFile","log","readEntries","out","entries","length","process","i","isClosed","entry","fileName","match","processFile","uncompressed","compressionMethod","JSInflate","inflate","isBinary","name","contents","btoa","encoding","String2ArrayBuffer","blob","Blob","type","fr","FileReader","onload","e","target","result","onerror","readAsText","loadScript","readSelectedFiles","filesToRead","pb","errorsMessages","setLabel","readSecuencial","sec","close","showErrorMessage","f","binary","reader","ext","fileExtension","toLowerCase","ex","dataFromURLData","error","readAsArrayBuffer","readAsDataURL","dialogbaseOptions","minWidth","autoOpen","closeText","str","modal","classes","iconModified","html","iconDelete","iconClose","iconRequired","iconReadOnly","iconFolder","filelist","filelistclose","new","rename","delete","multidelete","showparentfiles","comments","import","print","edit","undo","redo","select_all","find","find_replace","next","resetfiles","download","fullscreen","regularscreen","shortcuts","sort","run","running","debug","evaluate","console","about","info","alert","trash","retrieve","spinner","keyboard","clipboard","timeleft","copy","paste","more","less","resize","graphic","send","theme","user","fontsize","genIcon","icon","size","icons","split","ret","setTitleBar","dialog","buttons","handler","title","genButton","titleButtons","titleText","ih","button","click","css","on","this","blur","setDialogTitleIcon","message","onUserClose","sppiner","append","label","resizable","minHeight","event","originalEvent","t","text","titleTag","siblings","showMessage","initialoptions","options","extend","messageDialog","replace","messageButtons","ok","yes","stop","setMessage","men","currentOptions","requestAction","action","URL","noDialog","deferred","Deferred","request","xhr","apb","readyState","abort","ajax","beforeSend","jqXHR","async","url","JSON","stringify","contentType","dataType","always","done","response","success","resolve","reject","fail","textStatus","errorThrown","window","VPLDebugMode","undefined","clickServer","left","screen","w","top","h","features","open","attr","preventDefault","hide","acceptCertificates","servers","getLastAction","hasOwnProperty","n","m","monitorRunning","returnFalse","webSocketMonitor","coninfo","externalActions","setProtocol","setProcessId","processid","ws","defail","delegated","messageActions","content","parsed","exec","state","sanitizeText","detail","getConsole","isOpen","compilation","setResult","ajaxurl","supportWebSocket","WebSocket","monitorURL","notOpen","onopen","secure","delay","onclose","disconnect","onmessage","CLOSED","hideIDEStatus","showIDEStatus","status","show","init"],"mappings":"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"}